# 📊 学生成绩计算系统 - 使用说明

## 🎯 新增功能

### 1. 班级列支持

- 现在支持包含班级信息的数据
- 提供班级统计和班级平均分分析
- 可以按班级查看成绩分布

### 2. Level2-Level7 等级划分

- **Level2**: 最高等级（默认 ≥95 分）
- **Level3**: 优秀（默认 ≥90 分）
- **Level4**: 良好（默认 ≥85 分）
- **Level5**: 中等（默认 ≥80 分）
- **Level6**: 及格（默认 ≥75 分）
- **Level7**: 最低等级（默认 ≥70 分）

## 📁 文件格式要求

上传的 Excel 或 CSV 文件必须包含以下列：

| 列名     | 说明                    | 示例       |
| -------- | ----------------------- | ---------- |
| 姓名     | 学生姓名                | 张三、李四 |
| 学号     | 学生学号                | 20240001   |
| 班级     | 学生班级                | 一班、二班 |
| 甲部分数 | 甲部分数（满分 50 分）  | 45.5       |
| 乙部分数 | 乙部分数（满分 103 分） | 88.7       |

## 🚀 使用步骤

### 1. 访问程序

打开浏览器访问：`http://localhost:8501`

### 2. 上传文件

- 点击"选择文件"按钮
- 选择包含学生成绩的 Excel 或 CSV 文件
- 确保文件包含所有必要的列

### 3. 查看原始数据

- 系统会显示上传的原始数据
- 检查数据是否正确

### 4. 查看计算结果

- 系统自动计算总分、排序和排名
- 查看统计信息（总人数、平均分、最高分、最低分）

### 5. 设置等级划分

- 在"等级划分设置"区域调整各等级的 cutoff 分数
- 系统会实时更新等级划分结果

### 6. 查看最终结果

- 包含等级划分的完整结果
- 等级统计图表
- 班级统计和班级平均分

### 7. 下载结果

- 点击"下载 Excel 文件"按钮
- 保存处理后的完整数据

## 📊 计算规则

### 总分计算公式

```
总分 = (乙部分数/103 × 0.7) × 100 + (甲部分数/50 × 0.3) × 100
```

### 等级划分规则

- 系统按分数从高到低分配等级
- 每个等级都有对应的最低分数线（cutoff）
- 学生会被分配到达到的最高等级

## 📈 统计功能

### 基础统计

- 总人数
- 平均分
- 最高分
- 最低分

### 等级统计

- 各等级人数分布
- 等级统计图表

### 班级统计

- 各班级人数
- 班级平均分排名
- 班级成绩分布

### 分数分布

- 分数区间统计
- 排名-分数关系图

## 💡 使用技巧

### 1. 等级设置建议

- Level2: 95-100 分（最高等级）
- Level3: 90-94 分（优秀）
- Level4: 85-89 分（良好）
- Level5: 80-84 分（中等）
- Level6: 75-79 分（及格）
- Level7: 70-74 分（最低等级）

### 2. 数据准备

- 确保所有分数在合理范围内
- 甲部分数：0-50 分
- 乙部分数：0-103 分
- 班级名称保持一致

### 3. 结果分析

- 关注等级分布是否合理
- 查看班级间的成绩差异
- 分析分数分布情况

## 🔧 常见问题

### Q: 文件上传失败怎么办？

A: 检查文件格式是否正确，确保包含所有必要的列。

### Q: 等级划分不合理怎么办？

A: 调整各等级的 cutoff 分数，重新计算等级。

### Q: 如何查看特定班级的成绩？

A: 下载 Excel 文件后，可以使用 Excel 的筛选功能按班级筛选。

### Q: 程序无法访问怎么办？

A: 确保程序正在运行，尝试刷新浏览器或重启程序。

## 📞 技术支持

如有问题，请检查：

1. 文件格式是否正确
2. 列名是否匹配要求
3. 数据是否在有效范围内
4. 程序是否正常运行
