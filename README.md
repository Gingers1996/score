# 📊 学生成绩计算系统

一个基于 Streamlit 的 Web 应用程序，用于自动计算学生成绩、排名和等级划分。

## 🚀 功能特点

- **文件上传**: 支持 Excel (.xlsx, .xls) 和 CSV 文件格式
- **自动计算**: 根据公式自动计算总分
- **智能排序**: 按总分降序排列并计算排名
- **等级划分**: 可自定义 Level2-Level7 各等级的 cutoff 分数
- **数据可视化**: 提供统计图表和分数分布
- **结果导出**: 支持下载处理后的 Excel 文件
- **等级涂色**: 相同等级的行显示相同颜色

## 📋 计算规则

总分计算公式：

```
总分 = (乙部分数/103 × 0.7) × 100 + (甲部分数/50 × 0.3) × 100
```

## 🛠️ 本地安装和运行

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行应用程序

```bash
streamlit run app.py
```

### 3. 生成示例数据（可选）

```bash
python sample_data.py
```

## 🌐 在线部署

### 方案一：Streamlit Cloud（推荐）

1. **准备 GitHub 仓库**

   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/yourusername/student-grade-calculator.git
   git push -u origin main
   ```

2. **部署到 Streamlit Cloud**

   - 访问 [share.streamlit.io](https://share.streamlit.io)
   - 用 GitHub 账号登录
   - 选择您的仓库
   - 点击"Deploy"

3. **获取公开链接**
   - 部署完成后会获得类似 `https://your-app-name.streamlit.app` 的链接
   - 任何人都可以通过这个链接访问您的应用

### 方案二：本地网络共享

如果您的应用在本地运行，同一网络的人可以通过以下地址访问：

```bash
# 查看您的IP地址
ifconfig | grep "inet " | grep -v 127.0.0.1

# 其他人访问地址
http://您的IP地址:8501
```

## 📁 文件格式要求

上传的 Excel 或 CSV 文件必须包含以下列：

| 列名     | 说明                    | 数据类型 |
| -------- | ----------------------- | -------- |
| 姓名     | 学生姓名                | 文本     |
| 学号     | 学生学号                | 文本     |
| 班级     | 学生班级                | 文本     |
| 甲部分数 | 甲部分数（满分 50 分）  | 数值     |
| 乙部分数 | 乙部分数（满分 103 分） | 数值     |

## 🎯 使用步骤

1. **上传文件**: 点击文件上传区域，选择包含学生成绩的 Excel 或 CSV 文件
2. **查看原始数据**: 系统会显示上传的原始数据
3. **查看计算结果**: 系统自动计算总分、排序和排名
4. **设置等级**: 输入 Level2-Level7 各等级的 cutoff 分数（最低分数线）
5. **查看最终结果**: 包含等级划分的完整结果
6. **下载结果**: 点击下载按钮保存处理后的 Excel 文件

## 📊 输出结果

处理后的数据包含以下列：

- **原始列**: 姓名、学号、班级、甲部分数、乙部分数
- **计算列**: 总分、排名、等级
- **统计信息**: 总人数、平均分、最高分、最低分
- **可视化**: 等级分布图、分数分布图

## 🔧 技术栈

- **前端框架**: Streamlit
- **数据处理**: Pandas
- **文件处理**: openpyxl, xlsxwriter
- **数据可视化**: Streamlit 内置图表

## 📝 示例数据

程序包含一个示例数据生成器，可以生成 30 个学生的随机成绩数据用于测试。

## 🎨 界面预览

程序提供现代化的 Web 界面，包含：

- 响应式布局
- 直观的数据表格
- 实时统计指标
- 交互式图表
- 文件上传和下载功能

## 🔍 注意事项

1. 确保上传文件包含所有必要的列
2. 甲部分数应在 0-50 分范围内
3. 乙部分数应在 0-103 分范围内
4. 系统会自动处理数据排序和排名
5. 等级划分基于您设置的 cutoff 分数

## 📞 支持

如有问题或建议，请检查：

1. 文件格式是否正确
2. 列名是否匹配要求
3. 数据是否在有效范围内
